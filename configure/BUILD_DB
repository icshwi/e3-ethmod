
## This RULE should be used in case of inflating DB files
## 

.PHONY: db

### We have to think how to find $(EPICS_BASE) and
### $(EPICS_HOST_ARCH) during driver.makefile
### Friday, November  3 16:44:55 CET 2017, jhlee
### Currently feasible solutoin without touching driver.makefile
### is the following:
###
### 0) source setE3Env.bash 3.15.4
### 1) make db
### 2) make install
### 3) source setE3Env.bash 3.15.5
### 4) make db
### 5) make install 
###   ..... 

db: conf
	@install -m 644 $(TOP)/template/*.substitutions $(EPICS_MODULE_SRC_PATH)/ethmodApp/Db/

ifndef $(EPICS_BASE)
	$(QUIET) echo ""
	$(QUIET) echo "No EPICS_BASE is defined. Sourcing.... "
	$(QUIET) echo "We are using the default and only one EPICS base in order to inflat sub files to db files"
	$(QUIET) bash -c "source $(TOP)/$(E3_ENV_NAME)/setE3Env.bash && make $(M_OPTIONS) db"

else
	$(QUIET) make $(M_OPTIONS) db

endif
